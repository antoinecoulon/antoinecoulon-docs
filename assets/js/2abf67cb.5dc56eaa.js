"use strict";(self.webpackChunkantoinecoulon_docs=self.webpackChunkantoinecoulon_docs||[]).push([[2882],{1461:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>o,contentTitle:()=>a,default:()=>d,frontMatter:()=>l,metadata:()=>r,toc:()=>u});const r=JSON.parse('{"id":"documentation/G\xe9n\xe9ral/Divers","title":"Notions diverses","description":"Notions diverses de dev","source":"@site/docs/documentation/G\xe9n\xe9ral/Divers.md","sourceDirName":"documentation/G\xe9n\xe9ral","slug":"/documentation/G\xe9n\xe9ral/Divers","permalink":"/antoinecoulon-docs/docs/documentation/G\xe9n\xe9ral/Divers","draft":false,"unlisted":false,"editUrl":"https://github.com/antoinecoulon/antoinecoulon-docs/tree/master/docs/documentation/G\xe9n\xe9ral/Divers.md","tags":[],"version":"current","frontMatter":{"description":"Notions diverses de dev"},"sidebar":"tutorialSidebar","previous":{"title":"Design Patterns","permalink":"/antoinecoulon-docs/docs/documentation/G\xe9n\xe9ral/Design_patterns"},"next":{"title":"D\xe9ploiement","permalink":"/antoinecoulon-docs/docs/documentation/G\xe9n\xe9ral/D\xe9ploiement"}}');var t=n(4848),i=n(8453);const l={description:"Notions diverses de dev"},a="Notions diverses",o={},u=[{value:"Ressources diverses",id:"ressources-diverses",level:2},{value:"HTTP et requ\xeates",id:"http-et-requ\xeates",level:2},{value:"Guard Clauses",id:"guard-clauses",level:2},{value:"Tests",id:"tests",level:2},{value:"Tests unitaires",id:"tests-unitaires",level:3},{value:"Tests fonctionnels",id:"tests-fonctionnels",level:3},{value:"S\xe9curit\xe9",id:"s\xe9curit\xe9",level:2},{value:"Attaque XSS (cross-site scripting)",id:"attaque-xss-cross-site-scripting",level:3},{value:"Attaque XSS par l&#39;URL",id:"attaque-xss-par-lurl",level:3},{value:"Injections SQL",id:"injections-sql",level:3},{value:"Attaque CSRF (cross-site request forgery)",id:"attaque-csrf-cross-site-request-forgery",level:3},{value:"Attaque par force brute",id:"attaque-par-force-brute",level:3},{value:"En r\xe9sum\xe9, pour se prot\xe9ger",id:"en-r\xe9sum\xe9-pour-se-prot\xe9ger",level:3}];function c(e){const s={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.header,{children:(0,t.jsx)(s.h1,{id:"notions-diverses",children:"Notions diverses"})}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.em,{children:"\xe0 trier et organiser..."})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"#notions-diverses",children:"Notions diverses"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#ressources-diverses",children:"Ressources diverses"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#http-et-requ%C3%AAtes",children:"HTTP et requ\xeates"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#guard-clauses",children:"Guard Clauses"})}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"#tests",children:"Tests"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#tests-unitaires",children:"Tests unitaires"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#tests-fonctionnels",children:"Tests fonctionnels"})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"#s%C3%A9curit%C3%A9",children:"S\xe9curit\xe9"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#attaque-xss-cross-site-scripting",children:"Attaque XSS (cross-site scripting)"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#attaque-xss-par-lurl",children:"Attaque XSS par l'URL"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#injections-sql",children:"Injections SQL"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#attaque-csrf-cross-site-request-forgery",children:"Attaque CSRF (cross-site request forgery)"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#attaque-par-force-brute",children:"Attaque par force brute"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#en-r%C3%A9sum%C3%A9-pour-se-prot%C3%A9ger",children:"En r\xe9sum\xe9, pour se prot\xe9ger"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"ressources-diverses",children:"Ressources diverses"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.a,{href:"https://www.root-me.org/",children:"Root me"})," - Security, training"]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"http-et-requ\xeates",children:"HTTP et requ\xeates"}),"\n",(0,t.jsx)(s.p,{children:"Il y a plein de fa\xe7ons diff\xe9rentes d'acc\xe9der \xe0 une API afin d'en lire les donn\xe9es (commandes, navigateur, postman...)."}),"\n",(0,t.jsx)(s.p,{children:"Une API est donc cross-platoform et ne d\xe9pend pas d'un OS sp\xe9cifique."}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"guard-clauses",children:"Guard Clauses"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Tests fonctionnels"}),"\n",(0,t.jsx)(s.li,{children:"Logs (Journalisation)"}),"\n",(0,t.jsx)(s.li,{children:"Affichage front Cross-Platform (Android/IOS par ex), Micro-services"}),"\n",(0,t.jsx)(s.li,{children:"Le client peut v\xe9rifier la fonctionnalit\xe9"}),"\n",(0,t.jsx)(s.li,{children:"Centraliser et rendre le code fonctionnel homog\xe8ne"}),"\n",(0,t.jsx)(s.li,{children:"Plus de throw (dans la couche m\xe9tier), moins d'exception"}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Aller plus loin:"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"https://dev.to/maximegel/guard-clauses-explained-13aa",children:"Guard Clauses"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"https://refactoring.guru/replace-nested-conditional-with-guard-clauses",children:"Replace Nested Conditionnals with Guard Clauses"})}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:"Ex: Au lieu de if...else, on utilise des codes et des messages associ\xe9s"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"PS D:\\AndroidStudioProjects\\ApiArticle> node app.js\nLe serveur a d\xe9marr\xe9\n2025-03-18T12:56:13.081Z info: Code : 200 - Message : La liste des articles a \xe9t\xe9 r\xe9cup\xe9r\xe9e avec succ\xe8s !\n2025-03-18T13:02:44.447Z info: Code : 200 - Message : La liste des articles a \xe9t\xe9 r\xe9cup\xe9r\xe9e avec succ\xe8s !\n2025-03-18T13:07:44.587Z info: Code : 200 - Message : La liste des articles a \xe9t\xe9 r\xe9cup\xe9r\xe9e avec succ\xe8s !\n"})}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"tests",children:"Tests"}),"\n",(0,t.jsx)(s.h3,{id:"tests-unitaires",children:"Tests unitaires"}),"\n",(0,t.jsxs)(s.p,{children:["Tester ",(0,t.jsx)(s.strong,{children:"unitairement"})," des fonctionnalit\xe9s"]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Objectif"})," : V\xe9rifier que chaque unit\xe9 ou composant du code fonctionne correctement de mani\xe8re isol\xe9e. Une unit\xe9 peut \xeatre une fonction, une m\xe9thode ou un objet."]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Port\xe9e"})," : Tr\xe8s limit\xe9e. Les tests unitaires se concentrent sur une petite partie du code \xe0 la fois."]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Ind\xe9pendance"})," : Les tests unitaires sont g\xe9n\xe9ralement ind\xe9pendants les uns des autres. Ils ne d\xe9pendent pas de l'\xe9tat du syst\xe8me ou des autres tests."]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Rapidit\xe9"})," : Les tests unitaires sont rapides \xe0 ex\xe9cuter car ils ne n\xe9cessitent pas de configuration complexe ou d'interaction avec des syst\xe8mes externes."]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"\xc9criture"})," : Souvent \xe9crits par les d\xe9veloppeurs eux-m\xeames, parfois avant m\xeame que le code soit \xe9crit (dans le cadre du d\xe9veloppement pilot\xe9 par les tests, TDD)."]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Outils"})," : Utilisent des frameworks comme JUnit pour Java, NUnit pour .NET, ou pytest pour Python."]}),"\n",(0,t.jsx)(s.h3,{id:"tests-fonctionnels",children:"Tests fonctionnels"}),"\n",(0,t.jsx)(s.p,{children:"Tester une fonctionnalit\xe9, mais enti\xe8re"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Objectif"})," : V\xe9rifier que le syst\xe8me dans son ensemble fonctionne comme pr\xe9vu du point de vue de l'utilisateur final. Ils testent les fonctionnalit\xe9s compl\xe8tes du logiciel."]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Port\xe9e"})," : Plus large que les tests unitaires. Ils peuvent couvrir plusieurs composants ou modules du syst\xe8me."]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"D\xe9pendance"})," : Les tests fonctionnels peuvent d\xe9pendre de l'\xe9tat du syst\xe8me ou des r\xe9sultats d'autres tests."]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Dur\xe9e"})," : Peuvent \xeatre plus longs \xe0 ex\xe9cuter car ils impliquent souvent des interactions avec des bases de donn\xe9es, des interfaces utilisateur, ou d'autres syst\xe8mes externes."]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"\xc9criture"})," : Souvent \xe9crits par des testeurs ou des \xe9quipes QA, bien que les d\xe9veloppeurs puissent \xe9galement y contribuer."]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Outils"})," : Utilisent des outils comme Selenium pour les tests d'interface utilisateur, ou des frameworks comme Cucumber pour les tests d'acceptation."]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.em,{children:"Les tests unitaires et les tests fonctionnels sont compl\xe9mentaires. Les tests unitaires permettent de s'assurer que chaque composant fonctionne correctement en isolation, tandis que les tests fonctionnels v\xe9rifient que le syst\xe8me dans son ensemble r\xe9pond aux exigences et fonctionne comme pr\xe9vu pour les utilisateurs finaux. Les deux types de tests sont essentiels pour garantir la qualit\xe9 et la fiabilit\xe9 du logiciel."})}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"s\xe9curit\xe9",children:"S\xe9curit\xe9"}),"\n",(0,t.jsx)(s.h3,{id:"attaque-xss-cross-site-scripting",children:"Attaque XSS (cross-site scripting)"}),"\n",(0,t.jsx)(s.p,{children:"L'id\xe9e est d'injecter des balises HTML dans notre site victime \ud83d\ude06."}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"\ud83d\ude08 Comment la r\xe9aliser ?"})}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsx)(s.li,{children:"Trouvez un site web o\xf9 un formulaire vous permet d'ajouter du contenu au site, ou de participer \xe0 celui-ci. Par exemple, Wikip\xe9dia, ou un formulaire de commentaire sous un article de blog."}),"\n",(0,t.jsx)(s.li,{children:"\xc9crivez des balises HTML dans les champs du formulaire. Par exemple, < h1>hihihi< /h1>."}),"\n",(0,t.jsx)(s.li,{children:'Soumettez le formulaire. Votre "commentaire" sera alors sauvegard\xe9 en base de donn\xe9e.'}),"\n",(0,t.jsxs)(s.li,{children:["Rafra\xeechissez la page, et regardez si votre balise HTML est toujours l\xe0, et bien interpr\xe9t\xe9e par le navigateur (ie le texte ",(0,t.jsx)(s.em,{children:"hihihi"})," s'affiche en grand). Si oui, vous avez r\xe9ussi une attaque XSS ! \ud83d\udc4d"]}),"\n",(0,t.jsx)(s.li,{children:'Vous pouvez maintenant passer \xe0 l\'\xe9tape sup\xe9rieure et injecter des balises " img " ou plus vilain encore, des balises " script "\xa0\ud83d\udd25'}),"\n",(0,t.jsx)(s.li,{children:"Tous les visiteurs verront/subiront votre attaque !"}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"\ud83d\udee1\ufe0f Comment auraient-ils d\xfb se prot\xe9ger ?"})}),"\n",(0,t.jsx)(s.p,{children:"Avant de sauvegarder les donn\xe9es d'utilisateurs peu fiables en base de donn\xe9es, ils auraient d\xfb utiliser la fonction strip_tags() de PHP pour retirer toutes les balises HTML ! Concr\xe8tement :"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-php",children:"//en traitant un formulaire\n\n$username = strip_tags($_POST['username']);\n\n$comment\xa0 = strip_tags($_POST['comment']);\n\n//et ainsi de suite pour toutes les donn\xe9es !\n"})}),"\n",(0,t.jsxs)(s.p,{children:["En 2e couche de protection, au moment de l'affichage, ils auraient d\xfb transformer les balises en entit\xe9s HTML avec la fonction PHP htmlentities(). Ceci aurait ",(0,t.jsx)(s.em,{children:"d\xe9sactiv\xe9"})," les balises. Concr\xe8tement :"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-html",children:'<div class="comment">\n\n<div>Auteur : <?= htmlentities($username) ?></div>\n\n<p><?= htmlentities($comment) ?></p>\n\n</div>\n'})}),"\n",(0,t.jsx)(s.h3,{id:"attaque-xss-par-lurl",children:"Attaque XSS par l'URL"}),"\n",(0,t.jsx)(s.p,{children:"Les donn\xe9es d'un utilisateur peuvent provenir d'un formulaire, mais aussi directement depuis l'URL ! Il est donc possible de r\xe9aliser des attaques XSS (dites non-persistantes) en manipulant les param\xe8tres des urls \ud83d\ude06."}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"\ud83d\ude08 Comment la r\xe9aliser ?"})}),"\n",(0,t.jsxs)(s.p,{children:["Par exemple, en r\xe9alisant une recherche sur ",(0,t.jsx)(s.a,{href:"http://allocine.fr/",children:"http://allocine.fr"}),", on constate que le mot-clef saisi se retrouve dans l'URL ET est r\xe9affich\xe9 dans la page. Une recherche de ",(0,t.jsx)(s.em,{children:"batman"})," m'am\xe8ne sur l'URL http: //",(0,t.jsx)(s.a,{href:"http://www.allocine.fr/recherche/?q=batman",children:"www.allocine.fr/recherche/?q=batman"})," et mon terme de recherche m'est repr\xe9sent\xe9."]}),"\n",(0,t.jsxs)(s.p,{children:["Que se passe-t-il si je modifie ?q=batman par ?q=< h1>batman< /h1> dans la barre d'adresse ? Est-ce que ",(0,t.jsx)(s.em,{children:"batman"})," s'affiche en grand sur la page ? Si oui, attaque XSS par l'URL done !"]}),"\n",(0,t.jsx)(s.p,{children:"Malheureusement, l'attaque \xe9choue sur AlloCin\xe9 \ud83d\ude22."}),"\n",(0,t.jsx)(s.p,{children:"Mais d'ailleurs, est-ce que je ne suis pas en train de me hacker moi-m\xeame ? Quel est l'int\xe9r\xeat ?"}),"\n",(0,t.jsx)(s.p,{children:"Bonne question ! Il n'y a que nous qui voyons l'attaque, puisqu'elle n'est pas sauvegard\xe9 en bdd !"}),"\n",(0,t.jsx)(s.p,{children:"Mais si on on postait un lien comprenant notre attaque XSS sur un forum ? Les internautes qui cliqueraient dessus se retrouveraient sur le site victime, avec notre attaque XSS qui s'ex\xe9cuterait. On pourrait alors r\xe9cup\xe9rer leurs cookies de session, et ciao ciao !"}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"\ud83d\udee1\ufe0f Comment se sont-ils prot\xe9g\xe9s ?"})}),"\n",(0,t.jsx)(s.p,{children:"Comme pour les attaques XSS classique."}),"\n",(0,t.jsx)(s.p,{children:"En r\xe9cup\xe9rant le mot-clef dans l'URL, ils l'ont filtrer avec strip_tags()."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-php",children:"$keyword = strip_tags($_GET['q']);\n"})}),"\n",(0,t.jsxs)(s.p,{children:["Avant d'afficher ",(0,t.jsx)(s.em,{children:"mon"})," terme de recherche dans ",(0,t.jsx)(s.em,{children:"leur"})," page, ils l'ont filtr\xe9 avec htmlentities()."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-html",children:"<h2><?= htmlentities($keyword) ?> sur AlloCin\xe9</h2>\n"})}),"\n",(0,t.jsx)(s.h3,{id:"injections-sql",children:"Injections SQL"}),"\n",(0,t.jsx)(s.p,{children:"L'id\xe9e est de faire ex\xe9cuter nos propres requ\xeates SQL sur la base de donn\xe9es de notre site victime \ud83d\ude06."}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"\ud83d\ude08 Comment la r\xe9aliser ?"})}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsx)(s.li,{children:"Trouvez un site o\xf9 la soumission d'un formulaire d\xe9clenche selon vous une requ\xeate SQL. Pas trop difficile, c'est presque toujours le cas ! Par exemple, un formulaire de connexion va faire une requ\xeate SQL pour vous retrouver dans leur bdd..."}),"\n",(0,t.jsx)(s.li,{children:"Au lieu de taper votre pseudo dans le form, tapez plut\xf4t une requ\xeate SQL. Ou un bout de requ\xeate SQL."}),"\n",(0,t.jsx)(s.li,{children:"Si vous avez de la chance, votre requ\xeate sera ex\xe9cut\xe9e !"}),"\n",(0,t.jsx)(s.li,{children:"Si votre requ\xeate \xe9tait un DROP DATABASE, \xe7a fait bobo."}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsxs)(s.strong,{children:["\ud83d\ude08\ud83d\ude08  Oui d'accord, mais comment ",(0,t.jsx)(s.em,{children:"vraiment"})," la r\xe9aliser ?"]})}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsx)(s.li,{children:"Vous devez deviner quelle est la requ\xeate SQL ex\xe9cut\xe9e... Pour l'exemple d'un formulaire de login, c'est peut-\xeatre SELECT * FROM users WHERE username = 'monPseudo'"}),"\n",(0,t.jsxs)(s.li,{children:["Vous pouvez modifier la partie ",(0,t.jsx)(s.em,{children:"monPseudo"})," de cette requ\xeate, gr\xe2ce au formulaire !"]}),"\n",(0,t.jsx)(s.li,{children:"Tapez quelque chose comme '; DROP TABLE users; -- dans le champ de pseudo et soumettez le form !"}),"\n",(0,t.jsx)(s.li,{children:"La requ\xeate ex\xe9cut\xe9e devient alors :"}),"\n",(0,t.jsx)(s.li,{children:"SELECT * FROM users WHERE username = ''; DROP TABLE users; --'"}),"\n",(0,t.jsx)(s.li,{children:"Si vous avez de la chance, la table users a \xe9t\xe9 an\xe9antie \ud83d\ude3f"}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"\ud83d\udee1\ufe0f Comment auraient-ils d\xfb se prot\xe9ger ?"})}),"\n",(0,t.jsx)(s.p,{children:"Si l'injection SQL fonctionne, c'est certainement parce qu'ils ont fait cette m\xe9ga-gaffe pour cr\xe9er leur requ\xeate \xe0 partir de donn\xe9es provenant d'utilisateurs :"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-php",children:"<?php\n\n//r\xe9cup\xe8re la valeur du pseudo depuis le form\n\n$username = $_POST['username'];\n\n//cr\xe9e la requ\xeate en ins\xe9rant directement la variable dedans !! ouch.\n\n$sql = \"SELECT * FROM users WHERE username = '$username'\";\n\n//ex\xe9cute la requ\xeate\n\n//...\n\n//pleure\n"})}),"\n",(0,t.jsx)(s.p,{children:"Si la requ\xeate SQL est cr\xe9\xe9e \xe0 partir de sources pas fiables (ie. d'un formulaire ou de l'URL), il faut toujours pr\xe9parer la requ\xeate, puis utiliser les param\xe8tres nomm\xe9s :"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-php",children:'<?php\n\n//r\xe9cup\xe8re la valeur du pseudo depuis le form\n\n$username = $_POST[\'username\'];\n\n//cr\xe9e la requ\xeate avec un param\xe8tre nomm\xe9 !\n\n$sql = "SELECT * FROM users WHERE username = :username";\n\n//pr\xe9pare la requ\xeate\n\n$stmt = $pdo->prepare($sql);\n\n//remplace le param\xe8tre par la vraie valeur\n\n$stmt->bindValue(":username", $username);\n\n//ex\xe9cute la requ\xeate\n\n//...\n\n//rip les pirates\n'})}),"\n",(0,t.jsx)(s.p,{children:"Ils auraient \xe9t\xe9 prot\xe9g\xe9s virtuellement \xe0 100% seulement en faisant \xe7a. Un peu plus long, mais \xe7a vaut le coup !"}),"\n",(0,t.jsx)(s.h3,{id:"attaque-csrf-cross-site-request-forgery",children:"Attaque CSRF (cross-site request forgery)"}),"\n",(0,t.jsxs)(s.p,{children:["\xc0 prononcer ",(0,t.jsx)(s.em,{children:"siseurf"})," ! Eh oui !"]}),"\n",(0,t.jsx)(s.p,{children:"Plus compliqu\xe9e, cette attaque... Elle permet de faire faire des choses \xe0 notre victime sans qu'elle ne s'en rende compte, en exploitant g\xe9n\xe9ralement le fait qu'elle soit d\xe9j\xe0 connect\xe9 sur un site comportant des failles \ud83d\ude06."}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"\ud83d\ude08 Comment la r\xe9aliser ?"})}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsx)(s.li,{children:"Trouvez un site mal prot\xe9g\xe9, par exemple o\xf9 la soumission du formulaire de changement de mot de passe se fait en GET, et sans confirmation de l'ancien mdp."}),"\n",(0,t.jsx)(s.li,{children:"Assurez-vous que votre victime (un utilisateur du site) est actuellement connect\xe9 sur le site. He oui, c'est pas simple."}),"\n",(0,t.jsx)(s.li,{children:"Envoyez-lui un email comprenant un lien de ce type :"}),"\n",(0,t.jsxs)(s.li,{children:['< a href="http ://',(0,t.jsx)(s.a,{href:"http://www.site-mal-protege.com/change-password.php?newpass=tiguidou%22%3EVoir",children:'www.site-mal-protege.com/change-password.php?newpass=tiguidou">Voir'})," des chatons mignons< /a>"]}),"\n",(0,t.jsxs)(s.li,{children:["Si la victime clique sur votre lien, elle est amen\xe9e sans le savoir sur le site comportant la faille, et son mot de passe est chang\xe9 pour ",(0,t.jsx)(s.em,{children:"tigidou"})," !"]}),"\n",(0,t.jsx)(s.li,{children:"Vous pouvez maintenant vous connecter en tant que votre victime sur ce site, puisque vous connaissez son mot de passe."}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:["WTF ? Lorsque le site re\xe7oit la requ\xeate sur change-password.php, il v\xe9rifie d'abord si l'utilisateur est bien connect\xe9, pour savoir ",(0,t.jsx)(s.em,{children:"qui"})," est en train de changer son mot de passe. Et donc s'il doit proc\xe9der ou pas au changement en bdd."]}),"\n",(0,t.jsx)(s.p,{children:"Et... oui ! L'utilisateur est connect\xe9, vous vous en \xeates assur\xe9 avant d'envoyer votre email ! Alors le site ex\xe9cute r\xe9ellement la requ\xeate de changement de mot de passe !"}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.em,{children:"L'exemple de sc\xe9nario avec le changement de mot de passe n'en est qu'un, exemple. On aurait pu poster un message en son nom, supprimer son compte, d\xe9clencher un achat, ou un virement bancaire ! Nimporte quel form peut potentiellement \xeatre soumis ainsi !"})}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"\ud83d\udee1\ufe0f Comment auraient-ils d\xfb se prot\xe9ger ?"})}),"\n",(0,t.jsxs)(s.p,{children:["Tr\xe8s important \xe0 savoir : il n'est pas r\xe9ellement possible de savoir si une requ\xeate \xe0 votre site a \xe9t\xe9 d\xe9clench\xe9 ",(0,t.jsx)(s.em,{children:"depuis"})," votre site, ou d'ailleurs (bo\xeete mail ici). En tout cas, pas de mani\xe8re fiable."]}),"\n",(0,t.jsx)(s.p,{children:"Et pourtant, c'est bien la seule mani\xe8re de se prot\xe9ger... Avant de changer le mot de passe, on doit s'assurer que c'est bien l'utilisateur qui a rempli le formulaire, bien au chaud sur votre site."}),"\n",(0,t.jsx)(s.p,{children:"Voici donc la seule mani\xe8re qu'ils avaient de prot\xe9ger leurs utilisateurs :"}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsxs)(s.li,{children:["Avant l'affichage du formulaire, g\xe9n\xe9rer une cha\xeene al\xe9atoire impossible \xe0 deviner, avec random_bytes() en PHP. Cette cha\xeene est souvent appel\xe9e ",(0,t.jsx)(s.em,{children:"token"}),", ou jeton."]}),"\n",(0,t.jsx)(s.li,{children:"Stocker cette cha\xeene dans la session de l'utilisateur : $_SESSION['token'] = $token;"}),"\n",(0,t.jsx)(s.li,{children:"Placer ce token en valeur d'un input cach\xe9 du formulaire :"}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-html",children:'<form action="change-password.php">\n\n<input type="password" name="newpass">\n\n\x3c!-- Notre token ! --\x3e\n\n<input type="hidden" name="token" value="<?= $token ?>">\n\n<button>OK !</button>\n\n</form>\n'})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:["Lorsque le formulaire est soumis, ",(0,t.jsx)(s.em,{children:"s'assurer que le token re\xe7u (du formulaire) correspond bien \xe0 celui stock\xe9 en session"}),"."]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Si non, rejeter compl\xe8tement la demande, c'est trop louche !! b. Si oui, vous savez que c'est bien votre site qui a affich\xe9 ce formulaire, et vous pouvez proc\xe9der au changement de mot de passe en base de donn\xe9es."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Comment fonctionne cette protection ?"})}),"\n",(0,t.jsx)(s.p,{children:"Comment pouvons-nous contourner cette protection ??? Comment \xe9cririons nous notre lien maintenant ?"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-html",children:'  <a href="http://www.site-mal-protege.com/change-password.php?newpass=tiguidou&token=?????"> Voir des chatons mignons</a>\n'})}),"\n",(0,t.jsx)(s.p,{children:"On ne sait pas quelle valeur donner au token ! De toutes fa\xe7ons, si l'utilisateur n'est pas all\xe9 de lui-m\xeame sur le site, il n'a m\xeame pas de token en session ! Et nous sommes des pirates au ch\xf4mage. Ils nous ont kill."}),"\n",(0,t.jsxs)(s.p,{children:["Et oui, si vous vous posez la question : le site devrait en principe ins\xe9rer un tel token ",(0,t.jsx)(s.em,{children:"dans tous ses formulaires"})," !!! On ne se le cache pas, c'est du taf."]}),"\n",(0,t.jsxs)(s.p,{children:["Mais ",(0,t.jsx)(s.em,{children:"rejoice"})," : des frameworks comme Symfony incluent une protection totale contre les attaques CSRF par d\xe9faut !"]}),"\n",(0,t.jsx)(s.h3,{id:"attaque-par-force-brute",children:"Attaque par force brute"}),"\n",(0,t.jsx)(s.p,{children:"Par essais et erreurs, vous essayer de d\xe9terminer le mot de passe de votre victime et de vous connecter avec son compte \ud83d\ude06."}),"\n",(0,t.jsx)(s.p,{children:"Mais c'est un peu long \xe0 la mano... alors..."}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"\ud83d\ude08 Comment la r\xe9aliser ?"})}),"\n",(0,t.jsx)(s.p,{children:"Pour faire simple, imaginons que le formulaire de connexion soit fait en GET."}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsx)(s.li,{children:"Trouvez le pseudo ou l'email de votre victime (assez facile)"}),"\n",(0,t.jsx)(s.li,{children:"R\xe9aliser en PHP une requ\xeate vers le site :"}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-php",children:'<?php\n\n//tente de se connecter avec yo et abc comme identifiants\n\n$result = file_get_contents("https://www.lesite.com/login.php?pseudo=yo&pass=abc");\n'})}),"\n",(0,t.jsx)(s.p,{children:"On recherche sur StackOverflow comment g\xe9n\xe9rer toutes les combinaisons de lettres possibles : https ://stackoverflow.com/questions/2617055/how-to-generate-all-permutations-of-a-string-in-php\nPuis on ex\xe9cute la requ\xeate en boucle avec toutes ces permutations !"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-php",children:'<?php\n\n//une fonction qui g\xe9n\xe8re toutes les cha\xeenes possibles (voir 3.)\n\n$permutations = permute("abcdefghijklmnopqrstuvwxyz");\n\nforeach($permutations as $password){\n\n$result = file_get_contents("https://www.lesite.com/login.php?pseudo=yo&pass=$password");\n\n//quand on trouve le bon mdp... c\'est gagn\xe9.\n\n}\n'})}),"\n",(0,t.jsxs)(s.p,{children:["Et oui, c'est aussi possible de faire les requ\xeates en POST ! Voir ",(0,t.jsx)(s.a,{href:"https://stackoverflow.com/questions/5647461/how-do-i-send-a-post-request-with-php",children:"ici par exemple"}),"."]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"\ud83d\udee1\ufe0f Comment auraient-ils pu prot\xe9ger leur utilisateur ?"})}),"\n",(0,t.jsx)(s.p,{children:"Avant tout, disons bien que si l'utilisateur a choisi un mdp compliqu\xe9, ce sera beaucoup plus difficle pour nous de la deviner ! Plus long en tout cas."}),"\n",(0,t.jsx)(s.p,{children:"Mais le site pouvait-il faire quelque chose pour arr\xeater cette attaque ?"}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsx)(s.li,{children:"Ils pourraient compatibiliser le nombre d'essais erron\xe9s pour se connecter, puis verrouiller le compte apr\xe8s x essais infrutueux. Mais c'est \xe0 double tranchants ! Si un site se prot\xe8ge comme \xe7a, on peut le retourner contre lui et verrouiller le compte de tous ses utilisateurs en faisant des requ\xeates volontairement erronn\xe9es sur tous les pseudo qu'on puisse imaginer !"}),"\n",(0,t.jsx)(s.li,{children:"Idem, mais avec l'adresse IP. Ils pourraient bannir notre adresse IP apr\xe8s x requ\xeates en quelques secondes. Mais c'est tr\xe8s d\xe9licat \xe0 mettre en place en PHP."}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:["\xc0 vrai dire, mieux vaut s'en remettre \xe0 son sysadmin et lui dire de mettre en place ",(0,t.jsx)(s.a,{href:"https://www.fail2ban.org/",children:"fail2ban"})," \ud83d\udd76\ufe0f"]}),"\n",(0,t.jsx)(s.h3,{id:"en-r\xe9sum\xe9-pour-se-prot\xe9ger",children:"En r\xe9sum\xe9, pour se prot\xe9ger"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsx)(s.p,{children:"Attaques XSS"}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsx)(s.p,{children:"retirer les balises HTML avec strip_tags() quand on r\xe9cup\xe8re des donn\xe9es utilisateurs"}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsx)(s.p,{children:"\xe9chapper les caract\xe8res sp\xe9ciaux avant l'affichage avec htmlentities()"}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.a,{href:"https://www.php.net/manual/fr/function.strip-tags.php",children:"strip_tags"})," / ",(0,t.jsx)(s.a,{href:"https://www.php.net/manual/fr/function.htmlentities.php",children:"htmlentities"})]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsx)(s.p,{children:"Injections SQL"}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsx)(s.p,{children:"Toujours utiliser les requ\xeates pr\xe9par\xe9es, avec $pdo->prepare();"}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsx)(s.p,{children:"Les donn\xe9es de la requ\xeate sont plac\xe9es dans des param\xe8tres nomm\xe9s"}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.a,{href:"https://www.php.net/manual/fr/pdo.prepare.php",children:"prepare"})," / ",(0,t.jsx)(s.a,{href:"https://www.php.net/manual/fr/pdostatement.bindvalue.php",children:"bindvalue"})]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsx)(s.p,{children:"Attaques CSRF"}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsx)(s.p,{children:"G\xe9n\xe9rer un token al\xe9atoire avant chaque affichage de formulaire"}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsx)(s.p,{children:"S'assurer que le token envoy\xe9 est le m\xeame que celui en session"}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.a,{href:"https://www.php.net/manual/fr/function.random-bytes.php",children:"random_bytes"})," / ",(0,t.jsx)(s.a,{href:"https://www.php.net/manual/fr/reserved.variables.session.php",children:"sessions PHP"})]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsx)(s.p,{children:"Attaques par force brute"}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.a,{href:"https://www.fail2ban.org/",children:"fail2ban"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.hr,{})]})}function d(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>l,x:()=>a});var r=n(6540);const t={},i=r.createContext(t);function l(e){const s=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),r.createElement(i.Provider,{value:s},e.children)}}}]);